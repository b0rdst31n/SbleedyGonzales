name: "link_layer_encryption" 
poc_source: "https://github.com/mikeryan/crackle"
cve: ""
affected: "BLE devices using Link Layer encryption and LE Legacy Pairing"
profile: "LE"
type: "PoC - MitM, Information Leak"
automated: false
max_timeout: -1
bt_version_min: 4.0
bt_version_max: 5.4
hardware: ""
command: "crackle_runner.py"
file_type: "python3"
parameters:
  - name: "--target"
    name_required: true
    help: "Target MAC address"
    required: true
    parameter_connector: " "
directory: "crackle/"
description: "Crackle exploits a flaw in the BLE pairing process that allows an attacker to guess or very quickly brute force the TK (Temporary Key). With the TK and other data collected from the pairing process, the STK (Short Term Key) and later the LTK (Long Term Key) can be collected. With the STK and LTK, all communications between the master and the slave can be decrypted. Review https://github.com/mikeryan/crackle/blob/master/FAQ.md to get info about the requirements for the captured data."