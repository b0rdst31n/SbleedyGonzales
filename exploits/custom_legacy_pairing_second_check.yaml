name: "custom_legacy_pairing_second_check" 
poc_source: "https://github.com/sgxgsx/bluetoothexploits/tree/main/custom_exploits"
cve: ""
affected: "Especially BT < 4.2"
profile: "BR/EDR + LE"
type: "PoC - MitM"
mass_testing: true
max_timeout: -1
bt_version_min: 1.0
bt_version_max: 5.4
hardware: "hci"
command: "bluekit_legacy_pairing_second_check.py"
file_type: "python3"
parameters:
  - name: "--target"
    name_required: true
    help: "Target MAC address"
    required: true
    parameter_connector: " "
directory: "bluekit/"
description: "This script checks if a Bluetooth device uses legacy pairing, which relies on a PIN code for authentication and is less secure than modern pairing methods. The script captures Bluetooth communications with the target device using hcidump. It scans the output for a PIN Code Request event, which indicates legacy pairing. If this request is detected, the device is flagged as vulnerable since legacy pairing is susceptible to eavesdropping and man-in-the-middle attacks due to weaker encryption. If no PIN request is found, the device is considered secure from this specific vulnerability."
