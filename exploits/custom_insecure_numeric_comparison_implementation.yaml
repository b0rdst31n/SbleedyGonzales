name: "custom_insecure_numeric_comparison_implementation" 
poc_source: "https://github.com/sgxgsx/bluetoothexploits/tree/main/custom_exploits"
cve: ""
affected: "IVI systems in e.g. Audi, BMW, Hyundai, ..."
profile: "BR/EDR"
type: "PoC - MitM"
mass_testing: false
max_timeout: -1
bt_version_min: 1.0
bt_version_max: 5.4
hardware: "hci"
command: "bluekit_insecure_numeric_comparison_implementation.py"
python_version: 3
parameters:
  - name: "--target"
    name_required: true
    help: "Target MAC address"
    required: true
    parameter_connector: " "
directory: "bluekit/"
description: "This script tests for a vulnerability in Bluetooth device pairing by checking if a target device improperly implements Numeric Comparison. The vulnerability occurs if the device does not allow the user to confirm or deny pairing via a prompt. During setup, the script configures the Bluetooth agent in `DisplayYesNo` mode, removes previous connections, and initiates a scan and connection attempt with the target device. If pairing is successful, the script prompts the user to verify if the device displayed a pairing confirmation prompt. A missing prompt suggests vulnerability to pairing attacks, as the device is not enforcing user consent, which could lead to unauthorized access. The script reports the device as vulnerable if the prompt was absent, secure if it appeared, or errors if issues occurred during the test."
