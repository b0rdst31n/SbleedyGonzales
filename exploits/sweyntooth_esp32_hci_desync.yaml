name: "sweyntooth_esp32_hci_desync" 
poc_source: "https://github.com/Matheus-Garbelini/sweyntooth_bluetooth_low_energy_attacks"
cve: "CVE-2020-13595"
affected: "Espressif Systems"
profile: "LE"
type: "DoS"
automated: true
max_timeout: 20
bt_version_min: 4.0
bt_version_max: 5.4
hardware: "hci, nRF52840"
command: "esp32_hci_desync.py"
file_type: "python2.7"
parameters:
  - name: "port_nRF52840"
    name_required: False
    help: "Hardware port"
    required: true
    parameter_connector: ""
  - name: "target"
    name_required: False
    help: "Target MAC address"
    required: true
    parameter_connector: ""
directory: "sweyntooth/"
description: "The ESP32 BLE DoS vulnerability in Espressif Systems occurs due to a desynchronization between the ESP32 BLE controller and the host running the Apache Mynewt-Nimble stack. In specific scenarios, the controller incorrectly reports packet fragment counts, causing Nimble to restart and re-enable advertisements unnecessarily. This faulty recovery process results in the ESP32 failing to advertise, effectively disabling Bluetooth functionality. The attack requires an encrypted connection with pairing enabled and can be triggered by sending a precisely timed invalid packet, resulting in an MIC error. Devices using “just-works” pairing are at higher risk, though active sniffing tools like btle-jack can also initiate the attack."