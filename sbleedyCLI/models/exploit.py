class Exploit():
    def __init__(self, details : dict):
        self.name = details["name"]
        self.source = details["source"]
        self.cve = details["cve"]
        self.affected = details["affected"]
        self.profile = details["profile"]
        self.type = details["type"]
        self.mass_testing = details['mass_testing']
        self.bt_version_min = details['bt_version_min']
        self.bt_version_max = details['bt_version_max']
        self.python_version = details['python_version']
        self.hardware = details['hardware']
        self.command = details['command']
        self.parameters = details['parameters']
        self.parameters_names = [i['name'] for i in self.parameters]
        self.directory = details['directory']
        self.max_timeout = details["max_timeout"]
    
    def to_json(self):
        return {
            "name": self.name,
            "source": self.source,
            "cve": self.cve,
            "affected": self.affected,
            "profile": self.profile,
            "type": self.type,
            "mass_testing": self.mass_testing,
            "bt_version_min": self.bt_version_min,
            "bt_version_max": self.bt_version_max,
            "python_version": self.python_version,
            "hardware": self.hardware,
            "command": self.command,
            "parameters": self.parameters,
            "directory": self.directory,
            "max_timeout": self.max_timeout
        }
